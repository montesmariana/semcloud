<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="semcloud">
<title>Weight contexts • semcloud</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weight contexts">
<meta property="og:description" content="semcloud">
<meta property="og:image" content="https://montesmariana.github.io/semcloud/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">semcloud</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/processClouds.html">From SemasioFlow to NephoVis</a>
    <a class="dropdown-item" href="../articles/weightConcordance.html">Weight contexts</a>
    <a class="dropdown-item" href="../articles/HDBSCAN.html">HDBSCAN in token-level clouds</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/montesmariana/semcloud/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="weightConcordance_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Weight contexts</h1>
                        <h4 data-toc-skip class="author">Mariana Montes</h4>
            
            <h4 data-toc-skip class="date">2022-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/montesmariana/semcloud/blob/HEAD/vignettes/weightConcordance.Rmd" class="external-link"><code>vignettes/weightConcordance.Rmd</code></a></small>
      <div class="d-none name"><code>weightConcordance.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://montesmariana.github.io/semcloud">semcloud</a></span><span class="op">)</span></code></pre></div>
<p>This vignette shows how to generated tailored contexts for the visualization tools.</p>
<div class="section level2">
<h2 id="required-input">Required input<a class="anchor" aria-label="anchor" href="#required-input"></a>
</h2>
<p>The context-weighting procedure assumes the following datasets produced with <a href="https://montesmariana.github.io/semasioFlow" class="external-link"><code>semasioFlow</code></a> (Python):</p>
<ul>
<li>
<p>A dataframe with one row per context word and columns with frequency and weight information (most importantly, a column with the weight you would use for first-order filtering/weighting).</p>
<ul>
<li><p>The context word ID column is called <code>'cw'</code>.</p></li>
<li><p>The file would be typically called <code>'[lemma].ppmi.tsv'</code> and stored with your nephovis data (i.e. the <code>output_dir</code> in <code><a href="../articles/processClouds.html">vignette('processClouds')</a></code>. It is created by <a href="https://montesmariana.github.io/semasioFlow/semasioFlow.socmodels.html#semasioFlow.socmodels.targetPPMI" class="external-link"><code>semasioFlow.socmodels.targetPPMI()</code></a>.</p></li>
</ul>
</li>
<li>
<p>A dataframe with one row per context word per token, with corpus-based information.</p>
<ul>
<li>
<p>This is generated by <a href="https://montesmariana.github.io/semasioFlow/semasioFlow.contextwords.html#semasioFlow.contextwords.listContextwords" class="external-link"><code>semasioFlow.contextwords.listContextwords()</code></a> and will at least have:</p>
<ul>
<li>a <code>cw</code> column with the type of the context word</li>
<li>a <code>target_lemma</code> column with the type of the target</li>
<li>a <code>word</code> column with the word form</li>
<li>
<code>token_id</code> and <code>cw_id</code> columns</li>
<li>distance between context word and target and similar computed values.</li>
</ul>
</li>
<li><p>It will be typically called <code>'[lemma].cws.detail.tsv'</code>.</p></li>
</ul>
</li>
<li>
<p>A dataframe with one row per token and columns with annotation values or other variables, as well as columns with semicolon-separated context words.</p>
<ul>
<li><p>The token ID column is called <code>_id</code> and the context word columns start with <code>_cws.</code> followed by the (first part of) the name of the model. Crucially, it should be possible to parse the relevant parameter settings from the name of your model.</p></li>
<li><p>The file would be typically called <code>'[lemma].variables.tsv'</code> and stored with your nephovis data (i.e. the <code>output_dir</code> in <code><a href="../articles/processClouds.html">vignette('processClouds')</a></code>. It is the ‘token_register’ element in the list returned by <a href="https://montesmariana.github.io/semasioFlow/semasioFlow.socmodels.html#semasioFlow.socmodels.weightTokens" class="external-link"><code>semasioFlow.socmodels.weightTokens()</code></a> but it could also include manually added variables.</p></li>
</ul>
</li>
</ul>
<p>The first and second dataframes are loaded and merged by <code><a href="../reference/setupConcordancer.html">setupConcordancer()</a></code>, in order to add weighting information to the token-based register. The <code>pmi_columnname</code> in this function identifies the name of the column with weighting information (by default <code>'pmi_4'</code>) and renames it as <code>myweight</code>. There are two ways to point to the files in this function. If their names correspond to the naming convention <em>and</em> are stored in the same directory <code>nephodir</code>, you can run <code>setupConcordancer(lemma, nephodir)</code>. Otherwise, you can use <code>setupConcordancer(cws_detail_path = 'path/to/cws.detail.tsv', ppmi_path = 'path/to/ppmi.tsv')</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setupConcordancer.html">setupConcordancer</a></span><span class="op">(</span>cws_detail_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">cws_detail_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lemma</span>, <span class="st">'.cws.detail.tsv'</span><span class="op">)</span><span class="op">)</span>,
                         ppmi_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">nephodir</span>, <span class="va">lemma</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lemma</span>, <span class="st">'.ppmi.tsv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The third dataframe is loaded separately.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">nephodir</span>, <span class="va">lemma</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lemma</span>, <span class="op">(</span><span class="st">'.variables.tsv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                            show_col_types <span class="op">=</span> <span class="cn">F</span>, quote <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-weighted-concordances">Build weighted concordances<a class="anchor" aria-label="anchor" href="#build-weighted-concordances"></a>
</h2>
<p>The main function, <code><a href="../reference/weightConcordance.html">weightConcordance()</a></code>, takes both dataframes and the name of the lemma<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The name of the lemma is included in the names of the models, so this is required to swiftly remove them and re-add them.&lt;/p&gt;"><sup>1</sup></a> as input and returns an enriched version of the <code>variables</code> dataframe with a raw context in the <code>_ctxt.raw</code> column and tailored contexts in columns starting with <code>_ctxt.</code>, followed by (the first part of) the name of the model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctxts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightConcordance.html">weightConcordance</a></span><span class="op">(</span><span class="va">variables</span>, <span class="va">cws</span>, <span class="va">lemma</span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">ctxts</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">nephodir</span>, <span class="va">lemma</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">lemma</span>, <span class="op">(</span><span class="st">'.variables.tsv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, escape <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></code></pre></div>
<p>A tailored context wraps the target token and the words captured by the model with HTML tags to be read by the visualization tools:</p>
<ul>
<li><p>The target is wrapped in <code>&lt;span&gt;</code> tags with <code>class = "target"</code>, which NephoVis reads as bold and coloured based on the colour of the dot the token is connected to.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In order to keep &lt;code&gt;readr&lt;/code&gt; from escaping the quotation marks, we need to add &lt;code&gt;escape = 'none'&lt;/code&gt; to &lt;code&gt;&lt;a href=&quot;https://readr.tidyverse.org/reference/write_delim.html&quot; class=&quot;external-link&quot;&gt;readr::write_tsv()&lt;/a&gt;&lt;/code&gt;; in order to read them back, we need to add &lt;code&gt;quote = &quot;&quot;&lt;/code&gt; to &lt;code&gt;&lt;a href=&quot;https://readr.tidyverse.org/reference/read_delim.html&quot; class=&quot;external-link&quot;&gt;readr::read_tsv()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;"><sup>2</sup></a></p></li>
<li><p>Context words captured by a model for a token are wrapped in <code>&lt;strong&gt;</code> tags and are thus rendered in bold. It is also possible to add a weight as superscript.</p></li>
</ul>
<!-- A crucial point that can cause issues is that we are now adding double quotation marks to the text, which requires extra precautions with `readr`. You'll see that the new contexts wrap the target in HTML --><!-- `<span>` tags with `class = "target"`. In order to keep `readr` from escaping the quotation marks, we need to add `escape = 'none'` to `readr::write_tsv()`; in order to read them back, we need to add `quote = ""` to `readr::read_tsv()`: --><!-- ```{r, saveconcordance} --><!-- write_tsv(ctxts, file.path(github_dir, lemma, paste0(lemma, ('.variables.tsv'))), escape = 'none') --><!-- ctxts <- write_tsv(file.path(github_dir, lemma, paste0(lemma, ('.variables.tsv'))), quote = "") --><!-- ``` -->
</div>
<div class="section level2">
<h2 id="adapt-the-settings">Adapt the settings<a class="anchor" aria-label="anchor" href="#adapt-the-settings"></a>
</h2>
<p>The default settings of these functions assume a certain pattern in the names of the columns and how to extract parameter settings from them, but they can be adapted with various optional arguments. They allow the user to customize (1) how to read the model name, (2) how to translate names of parameters into selections of context words and (3) other corpus-related issues.</p>
<div class="section level3">
<h3 id="read-the-model-name">Read the model name<a class="anchor" aria-label="anchor" href="#read-the-model-name"></a>
</h3>
<p>The default model name created by <a href="https://montesmariana.github.io/semasioFlow" class="external-link"><code>semasioFlow</code></a> is made of two strings joined by a period (e.g. <code>'bound5-5lex.PPMIweight'</code>): the first encodes the first-order selection parameters (e.g. <code>'bound5-5lex'</code>) and the second, the weighting information (e.g. <code>'PPMIweight'</code>). If this information is not encoded in this way in your model names, you can adjust it with the <code>foc_param_fun</code> and <code>weight_param_fun</code> arguments (see <code><a href="../reference/weightLemma.html">?weightLemma</a></code>).</p>
<dl>
<dt><code>foc_param_fun</code></dt>
<dd>A function that takes the name of the model and returns a string with the first-order filters.
</dd>
<dd>The default is <code>function(m) stringr::str_split(m, '\\.')[[1]][[1]]</code>: the first element in a <code>.</code>-separated sequence.
</dd>
<dt><code>weight_param_fun</code></dt>
<dd>A function that takes the name of the model and returns a string with the weighting filters.
</dd>
<dd>The default is <code>function(m) stringr::str_split(m, '\\.')[[1]][[2]]</code>: the second element in a <code>.</code>-separated sequence.
</dd>
<dt><code>sup_weight_fun</code></dt>
<dd>A function that takes a string with weighting information as read by the function in <code>weight_param_fun</code> (e.g. <code>'PPMIweight'</code>) and returns a boolean value indicating whether PPMI values should be included as superindices in the tailored concordance. See <code><a href="../reference/weightLemma.html">?weightLemma</a></code>.
</dd>
<dd>The default is <code>function(weightparam) stringr::str_ends(weightparam, 'weight')</code>: context words are weighted if the weighting parameter ends in <code>'weight'</code>.
</dd>
<dd>If you wanted PPMI values to <em>always</em> be included next to captured context words, you could run <code>weightConcordance(variables, cws, lemma, sup_weight_fun = function(x) return(TRUE))</code>.
</dd>
</dl>
</div>
<div class="section level3">
<h3 id="interpret-parameter-settings">Interpret parameter settings<a class="anchor" aria-label="anchor" href="#interpret-parameter-settings"></a>
</h3>
<p>The default values for interpreting the parameter settings are tailored to the corpus and setting used in <span class="citation">Montes (2021)</span>. You would want to instruct the function how to read <em>your</em> parameter settings instead. See <code><a href="../reference/filterWeight.html">?filterWeight</a></code> and <code><a href="../reference/filterFoc.html">?filterFoc</a></code>. In these descriptions, <code>foc_param</code> refers to the first-order information as read by the function in <code>foc_param_fun</code> (e.g. <code>'bound5-5lex'</code> and <code>weight_param</code> to the weighting information as read by the function in <code>weight_param_fun</code> (e.g. <code>'PPMIweight'</code>).</p>
<p>These instructions are used to identify which context words are captured by the model for each token; in addition, the semicolon-separated list of context words in the original file is also used.</p>
<dl>
<dt>
<code>is_dep_fun</code> and <code>max_steps_fun</code>
</dt>
<dd>Functions that take <code>foc_param</code> and returns <code>TRUE</code> if dependency information should be collected (for the former) and the number of steps in the dependency path to accept as viable context words (for the latter).
</dd>
<dd>The default value of <code>is_dep_fun</code> is <code>function(foc_param) stringr::str_starts(foc_param, 'LEMMA')</code>: dependency information is only used if the string starts with <code>'LEMMA'</code>.
</dd>
<dd>The default value of <code>max_steps_fun</code> is <code>function(foc_param) if (foc_param == 'LEMMAPATH2') 2 else 3</code>, which means that it restricts the steps for <code>LEMMAPATH2</code> models but only to 3 otherwise. This is only relevant if the result of <code>is_dep_fun</code> is <code>TRUE</code>.
</dd>
<dt><code>window_filter_fun</code></dt>
<dd>Function that takes <code>foc_param</code> and returns a vector or list with two elements, viz. the left and right window spans. Not used if the result of <code>is_dep_fun</code> is <code>FALSE</code>.
</dd>
<dd>The default value is <code><a href="../reference/windowFilter.html">windowFilter()</a></code> shown below: it extracts digits separated by a hyphen and reads them as the left and right span respectively. If you only used one digit, e.g. <code>'5'</code> to refer to both windows, you could use something like <code>function(x) stringr::str_replace(x, '[^\\d]+([\\d]+)[^\\d]+', '\\1-\\1')</code>.
</dd>
</dl>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">windowFilter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">foc_param</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">windows</span> <span class="op">&lt;-</span> <span class="va">foc_param</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="st">'\\d+-\\d+'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="st">'-'</span><span class="op">)</span>
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html" class="external-link">parse_integer</a></span><span class="op">(</span><span class="va">windows</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<dl>
<dt><code>pos_filter_fun</code></dt>
<dd>Function that takes <code>foc_param</code> and returns a vector; if it is empty, no filter is implemented, while if it has values, only the rows for which the column <code>pos</code> matches an element in the list will be included. Not used if the result of <code>is_dep_fun</code> is <code>FALSE</code>.
</dd>
<dd>The default value is <code><a href="../reference/posFilter.html">posFilter()</a></code> shown below: if <code>foc_param</code> ends in <code>'lex'</code>, only context words with <code>'noun'</code>, <code>'adj'</code>, <code>'adv'</code> or <code>'verb'</code> as <code>pos</code> will be considered captured; otherwise, all of them will.
</dd>
<dd>If the <code>'lex'</code> ending means something else in your data, you can replace the function with a customized version that used your own list of parts of speech as filter. If the name of the parameter setting is different, or even if you have multiple possibilities, you can adapt the function to those requirements as well.
</dd>
</dl>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">posFilter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">foc_param</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_ends</a></span><span class="op">(</span><span class="va">foc_param</span>, <span class="st">'lex'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'noun'</span>, <span class="st">'adj'</span>, <span class="st">'adv'</span>, <span class="st">'verb'</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<dl>
<dt><code>bound_filter_fun</code></dt>
<dd>Function that takes <code>foc_param</code> and returns <code>TRUE</code> if the words outside the sentence are also captured and <code>FALSE</code> if they should be excluded.
</dd>
<dd>The default is <code>function (foc_param) stringr::str_starts(foc_param, 'nobound')</code>: words outside the sentence are accepted if <code>foc_param</code> starts with <code>'nobound'</code>. If this parameter does not vary in your models and is not even recorded in the model name, you should use a function such as <code>function(x) return TRUE</code>.
</dd>
<dt>
<code>weight_filter_fun</code> and <code>threshold</code>
</dt>
<dd>The former is a function that takes <code>weight_param</code> and returns <code>TRUE</code> if weighting should be included and <code>FALSE</code> if it should be ignored. Including weighting implies that the values in the <code>myweight</code> column (as defined by <code>setupConcordance()</code>) are used to filter context words. The <code>threshold</code> arguments sets the value used for filtering context words based on <code>myweight</code> if the output of <code>weight_filter_fun</code> is <code>TRUE</code>.
</dd>
<dd>The default is <code>function(weightparam) stringr::str_ends(weightparam, 'no', negate = TRUE)</code>: it only returns <code>FALSE</code> if the weighting parameter ends in <code>'no'</code>. The default threshold is 0.
</dd>
</dl>
</div>
<div class="section level3">
<h3 id="other-adjustments">Other adjustments<a class="anchor" aria-label="anchor" href="#other-adjustments"></a>
</h3>
<p>Depending on your corpus, there might be other adjustments you might want to do to how the output of <a href="https://montesmariana.github.io/semasioFlow/semasioFlow.contextwords.html#semasioFlow.contextwords.listContextwords" class="external-link"><code>semasioFlow.contextwords.listContextwords()</code></a> is read. The <code>clean_word_fun</code> function takes the value of the <code>word</code> column and cleans it, e.g. replacing backticks with single quotation marks, or transforming <code>'&lt;/sentence&gt;'</code> into <code>'&lt;br&gt;'</code> to start new sentences in new lines. In addition, the <code>to_remove</code> argument is a vector of strings matching <code>word</code> values that should be ignored. The default value is <code>c('&lt;sentence&gt;')</code>, meaning that rows with that value in the <code>word</code> column will be removed from the start.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-montes_2021">
<p>Montes, Mariana. 2021. “Cloudspotting: Visual Analytics for Distributional Semantics.” PhD thesis, Leuven: KU Leuven.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mariana Montes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
