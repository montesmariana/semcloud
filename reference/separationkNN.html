<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function takes a square matrix dmx that contains item by item
distances, and a factor classes
(with as many items as there are rows, and thus columns,
in dmx) that assigns a class to each item.
The function returns a measure q of how well the distances
in dmx 'capture' the classification in classes,
where distances are taken to  'capture a classification' to the extent
that items are (immediately) surrounded by other items from the same class,
and not by items from some other class.
Next to an overall cluster quality for all the data taken together,
the function also returns the cluster quality of individual points
and the  cluster quality of individual classes
(as well as the mean cluster quality over classes).
All these measures are called q in the output of the function."><title>Proportion of same-class nearest neighbours — separationkNN • semcloud</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Proportion of same-class nearest neighbours — separationkNN"><meta property="og:description" content="This function takes a square matrix dmx that contains item by item
distances, and a factor classes
(with as many items as there are rows, and thus columns,
in dmx) that assigns a class to each item.
The function returns a measure q of how well the distances
in dmx 'capture' the classification in classes,
where distances are taken to  'capture a classification' to the extent
that items are (immediately) surrounded by other items from the same class,
and not by items from some other class.
Next to an overall cluster quality for all the data taken together,
the function also returns the cluster quality of individual points
and the  cluster quality of individual classes
(as well as the mean cluster quality over classes).
All these measures are called q in the output of the function."><meta property="og:image" content="https://montesmariana.github.io/semcloud/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">semcloud</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/processClouds.html">From SemasioFlow to NephoVis</a>
    <a class="dropdown-item" href="../articles/weightConcordance.html">Weight contexts</a>
    <a class="dropdown-item" href="../articles/HDBSCAN.html">HDBSCAN in token-level clouds</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/montesmariana/semcloud/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Proportion of same-class nearest neighbours</h1>
      <small class="dont-index">Source: <a href="https://github.com/montesmariana/semcloud/blob/HEAD/R/purityk.R" class="external-link"><code>R/purityk.R</code></a></small>
      <div class="d-none name"><code>separationkNN.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a square matrix <code>dmx</code> that contains item by item
distances, and a factor <code>classes</code>
(with as many items as there are rows, and thus columns,
in <code>dmx</code>) that assigns a class to each item.
The function returns a measure <b>q</b> of how well the distances
in <code>dmx</code> 'capture' the classification in <code>classes</code>,
where distances are taken to  'capture a classification' to the extent
that items are (immediately) surrounded by other items from the same class,
and not by items from some other class.
Next to an <em>overall cluster quality</em> for all the data taken together,
the function also returns the <em>cluster quality of individual points</em>
and the  <em>cluster quality of individual classes</em>
(as well as the <em>mean cluster quality over classes</em>).
All these measures are called <b>q</b> in the output of the function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">separationkNN</span><span class="op">(</span><span class="va">dmx</span>, <span class="va">classes</span>, k <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"s-curve"</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dmx</dt>
<dd><p>A square matrix containing item by item distances</p></dd>
<dt>classes</dt>
<dd><p>A factor of the same length as the number of rows and columns
in <code>dmx</code>; the class in position <em>i</em> in <code>classes</code> is the
class assigned to the item of row <em>i</em> and column <em>i</em> in <code>dmx</code></p></dd>
<dt>k</dt>
<dd><p>The value of <code>k</code> that is to be used to identify the <code>k</code>
nearest neighbours. If <code>k</code> is not specified, then <code>k</code> is taken
to be either the total number of items divided by ten (if the number of
items divided by ten is smaller than the size of the smallest class),
or the size of the smallest class minus one (if the size of the smallest
class minus one is smaller than the total number of items divided by ten).
This default behaviour obviously is but a very crude attempt at guessing
a sensible value for <code>k</code>. Most of the time you probably want to
overrule this default behaviour. If you explicitly specify <code>k</code>,
all value from one up to the total number of items minus one are allowed.</p></dd>
<dt>weights</dt>
<dd><p>The <code>weights</code> argument determines how exactly the cluster
quality of a point is derived from the class membership of its k nearest neighbours.
This cluster quality is 'the weighted mean of class membership
values of these neighbours (1=same class as target item; 0=different class)',
with the weights being determined by the <code>weights</code> argument.
The weights are k numbers, the first of which indicates the weight if
the closest neighbour, the second of which indicates the weight of the
second closest neighbour, etc. The sum of the weights always is one.
When <code>weights</code> is <code>"linear"</code>, which is the default situation,
weights decrease linearly as one progresses through the set of neighbours
(starting from the one that is closest to the target item).
When <code>weights</code> is <code>"s-curve"</code>, weights decrease as one
progresses through the set of neigbours (starting from the one that is
closest to the target item) according to the s-shape of
<code>y&lt;-(40:-40)/10; plot(1:81, exp(y) / (1 + exp(y)), type="l")</code>,
but with the actual weights rescaled so that they add up to one.
Finally, when <code>weight</code> is <code>"none"</code>, all connections in the path
have equal weight. The actual weights that are used in a call to
<code>separationkNN()</code> can be found in the <code>weights</code> components in its output.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of the class <code>clustqualkNN</code>,
which is a list containing at least the following components:</p>
<dl><dt>globqual</dt>
<dd><p>The <em>global cluster quality</em> <b>q</b></p></dd>
<dt>meanclassqual</dt>
<dd><p>The mean of all <em>class-specific cluster quality values</em> <b>q</b></p></dd>
<dt>classqual</dt>
<dd><p>A table with for each class its <em>class-specific clusters quality</em> <b>q</b></p></dd>
<dt>pointqual</dt>
<dd><p>A numeric vector with for each item its <em>item-specific cluster quality</em> <b>q</b></p></dd>
<dt>weights</dt>
<dd><p>A numeric vector with the weights that were used</p></dd>
<dt>k</dt>
<dd><p>A number indication which <code>k</code> was used</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <b>q</b> measures are calculated as follows:
first, for each item an item-specific cluster quality is calculated.
This is done by calculating the proportion of 'same class items'
among its k nearest neighbours. The higher the measure, the better
the cluster quality for that item. However, what is calculated is not
simply the proportion, but rather the weighted mean of the values
of the k nearest neighbours, where a 'same class neighbour' has value one,
a 'different class neighbour' has value zero, and the weights of the
neighbours can have different settings (see below).
In the default settings, weights decrease linearly with their rank of
'distance from the item', and all weights add up to one. For instance,
if k is one then the weight is 1. If k is 2, then the weights, starting
from the closest nearest neighbour, are .67 and .33. If k is 3, then the
weights are .5, .33, and .17. If k is 4, they are .4, .3, .2, and .1. Etc.</p>
<p>The overall cluster quality of the data is then calculated as the
mean cluster quality of all items. Additionally, the cluster quality
for every class in <code>classes</code> is calculated as the mean cluster
quality of the items belonging to that class. The mean class quality,
finally, is the mean of all class-specific class quality measures.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># we create a 'point cloud', with points belonging to two classes</span></span>
<span class="r-in"><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">                <span class="va">dst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">points</span>, diag<span class="op">=</span><span class="cn">TRUE</span>, upper<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">                <span class="va">classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># we analyse the cluster quality, letting the procedure choose k</span></span>
<span class="r-in"><span class="va">fitkNN</span> <span class="op">&lt;-</span> <span class="fu">separationkNN</span><span class="op">(</span><span class="va">dst</span>, <span class="va">classes</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitkNN</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Length Class  Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classfreqs      2    table  numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classqual       2    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pointclass    100    factor numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pointqual     100    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> globqual        1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meanclassqual   1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k               1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights        10    -none- numeric</span>
<span class="r-in"><span class="va">fitkNN</span><span class="op">$</span><span class="va">globqual</span>        <span class="co"># global cluster quality</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6850909</span>
<span class="r-in"><span class="va">fitkNN</span><span class="op">$</span><span class="va">meanclassqual</span>   <span class="co"># mean class quality</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6850909</span>
<span class="r-in"><span class="va">fitkNN</span><span class="op">$</span><span class="va">classqual</span>       <span class="co"># class-specific quality</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a         b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6694545 0.7007273 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># we analyse the cluster quality, setting k to 25</span></span>
<span class="r-in"><span class="va">fitkNN</span> <span class="op">&lt;-</span> <span class="fu">separationkNN</span><span class="op">(</span><span class="va">dst</span>, <span class="va">classes</span>, k<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitkNN</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Length Class  Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classfreqs      2    table  numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classqual       2    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pointclass    100    factor numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pointqual     100    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> globqual        1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meanclassqual   1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k               1    -none- numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights        25    -none- numeric</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mariana Montes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

